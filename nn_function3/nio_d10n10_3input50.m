function [y1,xf1] = nio_d10n10_3input50(x1,xi1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
% with 50000 samples out targetiing ruptur 10
% Auto-generated by MATLAB, 10-May-2019 21:10:51.
%
% [y1,xf1] = myNeuralNetworkFunction(x1,xi1) takes these arguments:
%   x1 = 3xTS matrix, input #1
%   xi1 = 3x10 matrix, initial 10 delay states for input #1.
% and returns:
%   y1 = 1xTS matrix, output #1
%   xf1 = 3x10 matrix, final 10 delay states for input #1.
% where TS is the number of timesteps.

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [588;52;0];
x1_step1.gain = [0.000550206327372765;0.0045662100456621;2];
x1_step1.ymin = -1;

% Layer 1
b1 = [6.0566781250935770586;55.360599882817005835;2.1216218386127629891;9.284990244234643697;2.7033960058088704059;3.4981840191949715724;-16.111249293428269169;-11.89611288998210803;-36.774423284259498246;-19.61876788992616838];
IW1_1 = [-9.0785833904477613032 4.4511270571210372893 -2.4436213332956602251 7.9753099977327286396 -5.4324746377093990901 -2.4083417010759582411 -0.30207892857137658149 0.35417777891391349909 -0.12859533115961005456 2.7661939198747447222 -0.23156658085719442064 -0.63301699749913198367 -1.2096482384223026241 0.44601151273626943317 -0.0094901030102984181014 1.6856959039641561393 1.6095032626478749105 1.0644837908486584066 1.1093554077492495669 -1.0224084372538437826 -1.6292387607522142989 -2.9058889397148766065 -0.18063665848061663532 0.032970109495368875308 1.751149700518888519 -0.82575320092913750969 0.036225033373509060719 -1.9185998316207815151 0.66920377720810120259 -0.011824710141244606718;-63.451099343471291547 51.167608059704015488 -5.2197321691898430629 -49.232993961082797796 38.641183477111631817 5.2317948228395927401 -22.090538635260770661 43.333645928968444139 5.6624796370497323394 -26.733181132240005695 13.903823485296953777 -1.341746543335801789 22.625324055416911051 2.5664161815945014666 -3.4928551332308312993 33.022434170803123266 -0.32179828548843786296 -7.886507323059698038 18.648267531946167708 -5.4986625738339158787 -32.848696023436339431 20.857314619171802406 -30.828453386423859683 11.13000495791090394 26.609977671045676573 -42.045146162469592355 -5.8843907460878916993 35.451626693415406066 -64.253792361777897213 -15.632092425557312154;-16.856481109849813294 -7.8446021235944769501 -6.9811910057759929416 13.085828520422555954 -11.933676196738796094 -6.0204976881141920586 10.949783517729430926 12.311405734055638206 -0.0050838508460314879231 2.9101153138393733855 3.491314732411079369 -0.67270498720502747148 0.40968339207928783363 -1.8864207484740944665 -0.062357248460734648887 -13.974561908293154033 -0.83060786970523003969 -0.68972969953227281081 14.9534076603085051 -9.6204584299237989597 -0.40583526995521124192 2.9757169908190621577 5.0185859616575410058 0.079903854580981592548 -10.790312328514465534 -6.5574699640240519116 -0.022632797163757090858 -10.42021243464249558 -0.29138333216943612669 -0.072171917355664402804;-12.663034291286049182 6.3744642819183026106 -4.1273266718553669463 10.212388770026187501 -6.7795913305587198749 -3.4969520684462569449 -0.012339786545020194064 0.67556913049292444118 -0.033763192273701801704 3.6653589760568121569 -0.54627447128026673795 -0.7794696838739563205 -1.5355860751235752559 0.48775962866869027046 -0.0091410966860792780553 2.7525237069682013669 1.9620173893339787341 2.1103303219488278586 1.6009616218597677584 -1.3254879251933158191 -2.9571818000851353148 -4.0254917635395059961 -0.24632535882343747913 0.028554098513322523356 2.5638483501798443598 -1.0299440616409252236 0.038496865177276587411 -2.7751358588661294569 0.84942190385222537952 -0.012488351285131800081;16.588975258179811334 -8.4815247906459774185 -4.8505341221546682817 -4.4974632529917615287 3.3787815675379646585 -1.4205890118918280685 -3.2451827067586584974 -0.52611533577535729567 -0.24872458453828941161 -3.1270819854177860364 1.9180558622356564946 -0.2567209764929476723 -1.3606830971126790963 -0.01675131712918526139 0.047092967577499963983 -4.1863525448238414484 -2.2106604175199771056 -3.5199458139143566804 -3.0804124311700320504 0.23322137283011237785 2.6735776476960753101 4.8283879540970602307 -0.2743839597460223656 -0.027733000445658118754 -2.2527060487727901261 1.3932832707867139899 -0.034722927530990224665 1.5741860774638647413 -0.27540666667595409267 0.031522331046030534207;14.630659309209914198 -7.438693334484131725 -6.1699749414474371889 -3.385974864388118899 2.4232126170025303225 -0.7110737639967794621 -3.0937856012439417519 -0.63635512894343637669 -0.25112681436866468587 -2.4696958025242627954 1.7546667857925379863 -0.28449197133242049018 -1.1726479433682555076 0.065144021048767777882 0.037836940927029445725 -3.9755706850858580914 -1.7632597567073753364 -1.4989673838086112756 -2.8234371149052290839 0.1443627153719557743 0.86458121704420576314 4.0595460864082566488 -0.15108587731796169207 -0.0099666195427837844106 -2.0634465157784065426 1.085757220385854982 -0.020837082834750147303 1.4188199584483323079 -0.20712593799415307538 0.022840099268904019703;25.224705926701322056 -13.175890520232567127 2.8085132328821407199 6.3956131948876260296 -8.6485160754693648499 2.8387921316979682906 13.647516522814127526 -12.078606581026649636 -1.0888605198007166308 19.788446403386299011 -4.369091417825488044 -1.002692705535307649 6.564790738946122417 -2.4436322605971607658 -0.91528212739775038909 -6.386207698830025592 -5.5465938562848053905 2.8014508277506542377 -7.0026896879987425848 1.5880467155467303808 13.145599648471137044 -8.5270004808604866753 14.686577548619631273 -4.675522164968661798 -22.690560567632392264 12.039170052496505292 2.4946124876008415328 -29.006418748354040105 27.201748879300058803 6.2360793817787163462;-27.938198152326531698 9.3588321761355430795 8.0827059721659999525 1.8230736663544104825 -4.001700099381254816 1.965366324767841677 16.811483564340381491 -4.5659180729845809665 0.67662377431400078098 16.784458654434015301 -5.0666681918490628078 1.1084028698297681004 11.999587417784210785 -4.9735538143686666146 1.908319110955492004 9.5666057151340311293 -3.0076093141959754362 14.504636119733598676 15.523529030342839263 -6.2164486460745740359 1.1730517491032732558 -2.4804052306254944504 11.328084535268375888 3.0932304755820485553 -19.572473843470408639 11.888091199765966621 1.0515899221294626731 -28.809645685983696239 19.38851951179550781 -1.0044963178462817943;-45.665578077889961151 35.364288614112489029 19.369450294757335485 -54.713814212773350221 40.641363434608280158 9.0880383325096474323 -6.8230975994199871693 7.950921713360024512 5.1898199335677075439 27.402152249113665761 -4.3081640059810899501 3.7772548060789237212 32.425612024147163481 -18.685124529100662016 3.6599327548234352747 18.126750020383916251 -26.511448172680548652 -3.7473249234529584228 61.743561016664898489 -42.603700375305457726 12.083173684021298655 45.212583416615530041 8.9993245633939267236 -0.21442036295417207792 -24.186996635508656084 22.331885005143252698 -0.73222155967681112898 -57.686487049284572493 -8.2857975542103527999 -0.0609401906731487919;-25.443464651336110904 19.934411996919919829 15.817615813962763838 -59.609176410566085735 48.570260983499615293 9.3737103698046890798 -11.961450392314500135 5.867704752120856071 9.4292146902426452471 -3.8716387189595362628 -6.1256474879483455709 9.4140859641495229226 23.734506451560751117 -19.178743355770887291 -9.4571171263258655415 26.37234628181096241 -7.5200174794059595484 4.844074984663879313 28.865842488745755645 -18.571863940604103504 6.5514687063693326508 27.317162407480260811 2.8614606744246762204 -0.12774210907819419369 -0.2889386324565218489 18.93177607136609808 -1.3676032948671075218 -11.989060601362005798 -15.356184048770614936 -1.1359112437927569861];

% Layer 2
b2 = -3.314670939346576084;
LW2_1 = [19.997600984715404593 0.44194867938062076806 -0.19259963831152393521 -16.836683486123980913 17.184216254502096888 -18.039457440657375997 0.355831239970507196 -0.43112696760804575247 0.81960401054825604561 -0.50406819274187497637];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2;
y1_step1.xoffset = 0;

% ===== SIMULATION ========

% Dimensions
TS = size(x1,2); % timesteps

% Input 1 Delay States
xd1 = mapminmax_apply(xi1,x1_step1);
xd1 = [xd1 zeros(3,1)];

% Allocate Outputs
y1 = zeros(1,TS);

% Time loop
for ts=1:TS
    
    % Rotating delay state position
    xdts = mod(ts+9,11)+1;
    
    % Input 1
    xd1(:,xdts) = mapminmax_apply(x1(:,ts),x1_step1);
    
    % Layer 1
    tapdelay1 = reshape(xd1(:,mod(xdts-[1 2 3 4 5 6 7 8 9 10]-1,11)+1),30,1);
    a1 = tansig_apply(b1 + IW1_1*tapdelay1);
    
    % Layer 2
    a2 = b2 + LW2_1*a1;
    
    % Output 1
    y1(:,ts) = mapminmax_reverse(a2,y1_step1);
end

% Final delay states
finalxts = TS+(1: 10);
xits = finalxts(finalxts<=10);
xts = finalxts(finalxts>10)-10;
xf1 = [xi1(:,xits) x1(:,xts)];
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
