function [y1,xf1] = full_d10n16_r5(x1,xi1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 15-May-2019 18:49:42.
%
% [y1,xf1] = myNeuralNetworkFunction(x1,xi1) takes these arguments:
%   x1 = 3xTS matrix, input #1
%   xi1 = 3x10 matrix, initial 10 delay states for input #1.
% and returns:
%   y1 = 1xTS matrix, output #1
%   xf1 = 3x10 matrix, final 10 delay states for input #1.
% where TS is the number of timesteps.

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [588;52;0];
x1_step1.gain = [0.000550206327372765;0.0045662100456621;2];
x1_step1.ymin = -1;

% Layer 1
b1 = [-7.725209803748353643;1.5366225478598820597;1.128305930772562915;-4.6317531228342669891;0.2014507352615182989;4.3805026691386990123;-0.45270877868378855968;7.7853089561224155801;-0.11143177291563378939;0.56641796243971775926;-2.2768243552201048452;-2.4666060644644782762;0.33219068883299585071;-2.0733447912018192483;1.2559176667249303261;3.124762118069035477];
IW1_1 = [-17.40722861878254335 15.343510395863177109 5.7199407712218501842 -5.0417793534225339158 5.8376620303978983273 2.0609556290712327531 0.059270941475979194157 0.78771565617844085949 1.5076043021309952774 4.958938932516039344 -4.1529067279660072387 0.80248683337929538339 6.6432256485702154691 -3.5535466415632512849 -0.33437425939101750316 5.4792761682321726724 -4.6476260220675511547 -0.62749476160517769774 8.504491813118864485 -6.2441568981028074958 -0.13519466586641773476 4.6022972384220004471 0.083669416668614243759 0.18696412862632677543 -3.5505845460984262196 0.46336057075737796529 2.0267818360289946433 -5.5485478020128944365 0.48867576875215751331 -0.30430490620287808934;-0.24626270321976898026 -4.1451406654908273808 -2.7211876650837472091 3.0061175353409166355 -3.9961051613435709662 -0.98606494305503145092 2.8121787593767750835 -1.8849955810249001686 -0.96231788635100834473 0.88515195779698330192 0.82735815361707676363 -0.81010328316699198314 -1.7602475118578500002 2.1226081455700582801 -0.12542862745955862813 -2.108792490664211261 1.6843035810659736651 -0.40624761931528857728 -0.50570520236526417257 0.8552466582652968885 -0.0052753126331973486038 0.91218360949551702266 -1.1804015155275382476 -0.17661763582719081089 0.90701688604005870076 -1.1771505495807095265 -0.77576341278982186012 -0.54923333890400016788 -0.62836495317955320949 -1.242246912204923337;-0.29041057581795343134 0.027328637276159261499 0.36896085752588103635 -0.18572780845305400521 -0.38710065900431617214 0.19676790014703890441 0.15676401881810558825 0.45908570677092902512 -0.063639155833588423317 -0.042665237165073276182 -0.50968908604804574747 0.28713466086747557737 0.16099639045659197567 -0.15902905233407849117 -0.1615426949292379788 -0.36172181210253256944 0.32619951678795705563 -0.01484450417495353225 0.22914706781736318697 0.093671921329537652379 -0.43913034953137386474 0.37308783330751116303 0.24441158198384710376 0.17938286374967354897 0.17345029505158962579 0.0680456520238840179 0.43650831732667338958 -0.22889664650527175027 0.46521655942226003422 0.050462217623278404766;-10.066037203347258711 11.308691734699090503 3.9183860260123610786 -3.1932368153210273221 3.8742843306098144751 1.5355534159063386479 -1.6588380130648170407 -0.36593657320188899273 1.3141012336072799283 0.041925128268408190513 -3.3352095171639439819 0.79944849634646819592 3.722781478971408653 -2.6493309347603126724 0.0046395399044574089573 3.3839173852356498884 -2.2355841209706244221 -0.69966515978425880551 2.8232740559042972528 -1.3278388857049081562 0.57087219353117080178 1.4731569013135470403 0.6566814244441722126 -0.065479763566913332107 0.80315627431481639853 -0.26432986559170212892 1.1599259962424237624 1.5375247145048547281 -0.43602314018124044281 -0.17460601419199003881;-0.06119729987003297289 0.41033258286970525353 0.56002956270481774048 0.20614330091370478004 0.8420620454375530306 0.22816108697754722279 0.19458336069175494187 0.70677028769376626371 0.8210858312920090718 0.80507201269078698669 0.27782239850338336096 0.36562849020799015332 0.21183264865044770797 -0.020524678780953667379 0.3533308684352203799 0.01356792909253946855 0.45731998529098960571 0.58545430167331069526 0.033653598505948685571 0.14442085193753559369 0.59489832259473252041 0.56542584370117499049 0.5518809739411282278 0.23950495576483132876 0.81019584275705258669 0.13044937124308028653 0.061203677239165782398 0.51296975083110907256 0.17821533399772113149 0.36972180017367589633;5.3868690177362124061 -8.3035023230940119277 -3.1257147853599267506 3.7277974693610178569 -1.3387867337048677818 -1.0389198862136648227 1.3014722793836888126 0.90909001867379923834 -0.77411198299662287159 0.27137398250377486875 1.9930518627482749494 -0.33822555240654206266 -0.64316583644447034018 2.0268888791600989663 -0.18019498659818614095 -2.1302849020773506616 0.90043587118393397795 0.15508864388240031773 -0.86639364151906150813 -0.34407424137981729162 -0.011706464036614551427 -1.0439650541679155182 1.2269683241023938702 0.090797173540921261026 -2.89676666099620439 1.0202123951953649961 -0.5673752260792608304 -3.0343373829803228503 0.3484276998387300095 0.14189613551072388642;-1.8930292450574988106 2.140907174578828176 -0.85928469218760128445 -1.5101034273516464879 0.93973744539247450192 -0.22078249475182534778 -0.16385020449551374044 -0.13273081394238453457 0.087592145457002085207 0.23754695069199965873 -0.57077561424133216317 0.54847301745030896392 0.92065360355149394866 -0.4987044414833386452 0.66638711350693469182 0.66991554852098267325 -0.42424874784734872835 0.20105205723557567632 1.1596705633566199989 -0.49988079681519548281 2.9416523787839414794 0.88194516400456246519 0.16519641775073765078 -0.033676846376704983044 -0.40985417847910532441 0.16619690694137431719 0.3464991692546776636 -0.5633049268487165806 -0.19084615760353054736 -0.20745354144566127697;10.32356036030816604 -13.949221902483756708 -5.2018026005300663783 7.2313763359270897269 -4.3712459184489551589 -1.9777067700602621869 1.5641301279351915721 -0.18796230015997736351 -1.0405932585669441792 -2.5253527804161453041 3.9850256126342706864 -0.44506095393929129278 -3.9652082964493513551 4.7292760794415018566 0.032245279708881240122 -5.6636977437323619 3.5936731066738842877 0.17305082802548998888 -5.0590566416319111553 3.2112589344886162124 0.48970934410985939023 -2.8075710596541316733 1.1258291921367666877 -0.19452750117379097317 0.2096580956946768326 0.34820840353998799843 -1.2784882711703926539 0.81472361020441663726 0.161991204719028975 0.34270001212125567047;-3.9095742473178933807 3.3372507812222753643 1.6755687815034876476 -0.018717249647725347356 0.12207623087537616824 0.56616061875512513346 0.34289939476140368635 0.14237021158322968328 0.53474786316561606636 0.88546163997253057865 0.59796422969541673798 0.44685777367043455488 0.18687460375217221364 0.10343855547805398676 0.8336721188145372885 0.52923740492929982615 0.53211773195750800003 0.52425131985157935599 0.27990850533608008233 1.3255574092465183256 0.27195264041950478751 0.20858613490847613403 0.60457163821126969072 0.44249978571213954837 0.25060633675088567207 0.38049684622803875422 0.19613874220315569152 -0.18470686999295413133 0.14901022033878885686 0.13967193098782562655;4.5643452074444255118 -5.9869140685975041904 -3.057956207453202957 2.5522763776093571053 -1.2727007362934825707 -0.78379719813968551367 0.47788176147423561124 0.56946365382517516451 -0.79087430631540855952 -0.23617119845639128473 -0.22495950551064614054 -0.71798358697420294749 1.2696558785174230088 -1.1290377902260890774 -0.62055553034386323752 0.34054603209923811624 0.056487009299039069032 -0.72362693810752809487 -0.12056248542311923111 0.45542426447108330656 0.29682980140408182779 -1.1015436764467185782 0.65342684166129849643 0.0065823983447200985417 -2.0185727656037317779 -0.88559746329583233226 -0.74765105389296515614 -1.4128020231434161857 -1.1817213145399403373 -1.4567313434899882285;-1.5071198673356902553 1.7490285979539645922 1.7155864722230720343 0.257340210799154534 1.3374084855803496374 0.72164547239966780889 -0.11314753793500610668 1.1251425756017574553 0.54503496821334274092 -0.54964592450425719949 0.56723312480212884079 0.69790358939113528169 -0.28943912104212243808 1.4263467827599938254 0.68749688263181185643 -0.47065507247114063416 0.143321495010788863 0.63432524775644094639 0.42736647074342454244 0.11194969839796520272 0.37706719188556042655 0.4810962966575102473 0.050403717707964999784 0.11884295637193391382 0.72460224539687334566 0.50596946102482898144 -0.60933437406089874244 1.5528176133931319569 -0.76031274166849593943 -0.076172975288045494113;-7.2821037192289699291 3.7153830442666064826 -0.85040882090973357599 2.151189251280126058 -0.41034542780997163014 -0.095153431461483597986 0.20909710487328894701 0.37657445543410406064 -0.39764740291771732972 0.92949066893204412843 -0.60136783157553752588 -0.189962779414797861 1.3809395073007215693 -0.97381093132447682503 0.14703798830803729847 1.1951292971750508976 -0.63233219725564893121 0.2578218815568453226 1.4566354826378913323 -0.80777006044416954644 3.0997642159304970022 0.42653103414090259848 -0.42314552557059620375 0.0865011429574877172 -0.45983226184768505318 -0.75903514455034892805 1.0138125022659267849 -0.52113189488775846225 1.344924474204366005 -0.57539726638206634135;0.80137798459816367291 1.8268425064195037422 1.5373941632605918617 -1.328919731709287344 1.2812215357146630179 0.58807423193294339203 -0.51101014522961918374 0.65409206900851890598 0.66720356604593755723 -0.46109300226589761129 0.36355496143803550657 0.35535478152980715105 -0.09068485292424531552 0.086197311009160129669 0.67651835778023716728 -0.46876808124842017644 0.29078361634230881494 0.64091812388540192469 0.29954269069657624147 0.91565326692950188558 0.22819240327471498886 -0.12007132215735251413 0.6283244524399952402 0.56920688046326106679 -0.092506590520302217628 1.1527452833749169958 0.47495656249552303807 0.43852561294144026816 0.64881502051052997171 0.14062329638036580315;-0.14998985883542406694 -0.25131555185107562478 1.6542759123276831179 0.68090138559634705295 0.40069745666308004273 1.1182563311900053371 0.047845053259895534148 0.22239984777039642494 0.62854215044594186068 0.12329038384891420621 1.2832478914847391671 0.1023561735208632778 0.58663020706443080865 1.0413347949042575102 0.69580582996651629824 0.95852927382754060659 1.4683523209547690858 0.20685655616610557073 0.6111638268328998258 1.3835002255918760206 0.016947491487158180407 0.57308002803263746738 0.38088240923050692421 -0.25812782911869713853 -0.1844702843658244662 -0.26767969320993073579 0.65816820122926344983 0.36693302831677138132 -1.0447905439774778369 1.248621124676232208;0.32048197295463437539 -0.31592554831234098689 0.16508552664979042612 0.077927686840329302154 0.23965555922039444292 0.27512894671260762491 -0.33646172972329668749 0.31116822753400136259 0.49285606960184907832 0.40352291383173427564 0.12132440487406985496 -0.053345186115048660869 0.15685946512122206364 0.29868723953092024548 -0.30950933890885196087 -0.041517608582748236068 -0.32975209456674364761 -0.24499853585206338158 0.39274297810593455926 0.43953097522377260198 0.028612100071642835447 0.18500312033003363243 0.232757550488135595 -0.13373842561615176261 -0.30717407179150757468 -0.046608817764708827813 0.40011109960297258636 0.25272517708384706348 -0.34442321244711598949 0.37227992264354581309;-1.3615597570625239676 0.97115469601793225074 -1.6553882018280370314 0.81898408910239539615 -1.1087971417573914135 -0.44353024347625519264 -0.54768400860022614651 -0.088679549612665581337 -0.0079735490283775866532 -1.1156482763985045015 -0.61705395938753182516 -0.082118701783600644983 -0.38682120016578874777 -0.59444445770895848469 -0.75256966415058479392 0.3376724539878219189 0.12757041265573557109 -0.2789133850102444856 0.24018089278747561943 -0.75789927751098762343 -2.1789679449301848635 0.19582959235637531492 -0.6895379326074053683 -0.053089107945807366418 0.15095716886939730683 0.072092675830432759176 1.023907378707143101 1.9036888546736490113 1.6138600718499449549 -0.60537231891731035915];

% Layer 2
b2 = -3.7078329972500130296;
LW2_1 = [7.2191076404642622322 -2.3823260991195858161 0.0049744051279079814012 -7.4819200283511921867 -0.036294004550370240203 -6.8922233801012176002 4.5016488081855507986 5.1668670216604839496 3.8612136125330924763 2.0947136463037430154 -1.046821437517984732 -4.4919032446921880464 -2.4330393008006332423 -0.26620212270609733274 0.0014924756374267056543 4.5437194089933976571];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2;
y1_step1.xoffset = 0;

% ===== SIMULATION ========

% Dimensions
TS = size(x1,2); % timesteps

% Input 1 Delay States
xd1 = mapminmax_apply(xi1,x1_step1);
xd1 = [xd1 zeros(3,1)];

% Allocate Outputs
y1 = zeros(1,TS);

% Time loop
for ts=1:TS
    
    % Rotating delay state position
    xdts = mod(ts+9,11)+1;
    
    % Input 1
    xd1(:,xdts) = mapminmax_apply(x1(:,ts),x1_step1);
    
    % Layer 1
    tapdelay1 = reshape(xd1(:,mod(xdts-[1 2 3 4 5 6 7 8 9 10]-1,11)+1),30,1);
    a1 = tansig_apply(b1 + IW1_1*tapdelay1);
    
    % Layer 2
    a2 = b2 + LW2_1*a1;
    
    % Output 1
    y1(:,ts) = mapminmax_reverse(a2,y1_step1);
end

% Final delay states
finalxts = TS+(1: 10);
xits = finalxts(finalxts<=10);
xts = finalxts(finalxts>10)-10;
xf1 = [xi1(:,xits) x1(:,xts)];
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
