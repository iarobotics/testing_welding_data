function [y1,xf1] = nio_d10n10_3input(x1,xi1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
% this is without 50000 samples out on rupture 10
% Auto-generated by MATLAB, 10-May-2019 19:41:13.
%
% [y1,xf1] = myNeuralNetworkFunction(x1,xi1) takes these arguments:
%   x1 = 3xTS matrix, input #1
%   xi1 = 3x10 matrix, initial 10 delay states for input #1.
% and returns:
%   y1 = 1xTS matrix, output #1
%   xf1 = 3x10 matrix, final 10 delay states for input #1.
% where TS is the number of timesteps.

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0;18;0];
x1_step1.gain = [0.000431965442764579;0.0019782393669634;2];
x1_step1.ymin = -1;

% Layer 1
b1 = [-13.539498685609176576;-0.08355670080858662585;33.782400968278871289;-15.259453482008652259;124.91810185990469506;3.796588095399598739;1.8690593486342506058;4.4594728469189606201;5.3554037345912801626;-1.3689931694066774792];
IW1_1 = [94.833938733254214526 -127.06522953215066707 -28.006843055270536524 64.723542870748744349 -80.932355425365543056 -8.3058046593262773172 4.6660451904408466461 -20.777951859203284357 -6.2460790185660490792 -41.16932859283149071 15.024708265620912329 -1.7121170386833575172 -51.968000112227173304 24.000788746962033571 1.7948833045948762166 -16.994951288706680259 51.5231550685736579 2.0842659277111237337 -91.829152284694714581 118.8915792386318202 2.2558205241855255885 -63.38313937417957078 -19.824554685576156743 -1.0925110179085759654 31.711644864703750102 -45.134815845599398187 -9.9903419787958771536 78.732821985533718134 11.884340465775052209 0.20561772499181896201;-29.040668674671096028 24.761960194108411315 5.9853591651950006636 18.329234308944982956 -30.367789301214539677 6.5526832039135358698 19.598136969868029666 -29.610003595149024136 7.3186782036369057991 -0.34691206888216685744 -5.3987796504315443968 0.07320983525416460691 -10.998331794807892692 14.907388629886352049 -0.42299192214854974825 -4.3588252262437476858 27.126957221350963323 3.2103363749917028791 -3.5440605174425048318 -2.5651305407269360259 0.39764594116097207177 -4.8601848417492918841 -0.27964810676922413624 -0.81451030338700491917 5.4825601724861723341 10.873543422631948729 2.2415811110653045546 4.3586168939161398228 18.53815075976982385 0.41223566926513077746;-38.76628584336862815 38.187609636923291134 -16.177931294462368328 32.605544616118194767 -41.115080993028797707 -3.9912485213811206286 12.757708736918671022 -21.058179230183743158 -3.7638754919614307859 6.081392904739251648 -4.5274956818447655849 -0.20773535933146958232 -10.304403679426823004 10.203121229623125288 -0.55676044050610862257 1.685270140324761412 22.243339721628867522 0.98475189637703963719 -2.1410250551788450046 -4.0624496473167255317 0.33224779914777424761 -9.241075502146570031 -3.4646055285983470284 0.062454662022891321849 7.9864889697240366573 4.696015791697129238 1.1499124613334914535 -3.4754760103008415228 12.385038903721147463 0.39427410224552383866;48.277471567977606526 -57.785555580083482141 -6.5536775115948548986 -49.627964868822004973 55.356417917633855552 -1.4066437186945144333 0.61981705685377042059 5.533196007698913732 1.0824831203231517485 -16.820826105084233149 4.5901099103659728229 1.2710839159775488838 7.1245384475147908176 -3.6402632183808458777 2.9833481498839420354 -5.7899851652319833661 -14.624114340509773768 0.28299375545110283525 -1.2860085589195713318 6.5759367631122556119 -1.7698833104317983622 15.160113690238397055 8.4745246113272738597 15.545590112825477647 -10.077628018035342805 6.9852650920602430418 14.306865316594333137 11.7219894997360079 -1.4820227616174548313 -0.51169870919226234651;106.10546224766747514 -171.2597880507696857 -45.462496329473822243 64.159160287928472144 -113.22819557821027558 -30.384634893315407567 36.482848385156529503 -129.49956920283378281 -30.810832125386365732 17.579990361281812028 -45.63010462447027038 -30.911995501438241263 -44.661030673289218385 15.679006269390157513 -9.1281477957663863521 -51.299903192057968226 29.223826996188847716 -3.335354908149365194 -37.348660750554373067 33.386827732160853088 2.6340515912950408506 -34.523907322755846394 69.832218264399486429 2.3115075237507309858 -33.108599151813109529 136.71393820457390689 23.833426919728239568 -25.511002875570312654 195.27533865658702439 16.233323163407330725;-35.017161344491455566 31.913683396753199872 6.571594958647707152 -5.4004937245842805638 -3.776795915177996843 4.6307112937243433137 7.9041107588045766974 -1.6860230024324496245 4.9862993597883482622 7.7296634455493746785 -10.166505219260145054 -0.10900197923533465338 7.7422613375150701742 0.87183280461288115148 -0.081446882846352333662 1.2171738190260867896 12.61947952177183474 -0.14949169930976008436 9.7470511469176717156 3.9665923652212322637 -0.17174543774240719207 -1.7891009750867452599 -3.1737032454758571376 -0.029040650026434203235 -0.48628844177771873847 -7.3559708190907162617 0.49513537268556173654 1.8956923917890218245 -1.0812580906664999159 -1.0951484938523681212;-14.480458916745879705 3.6648512736507337095 -4.2435807808224801363 -12.757957598322553494 16.902494733082981782 -1.3677319123246556298 -1.0705311403003103798 8.8088865325906624548 0.67194141030348153443 -5.7198125185380419566 -4.010264647408317451 0.85073072309963337911 7.477486839987535383 -1.8263291551418683323 0.66354678872576489113 4.9534271883919904766 -3.5751795103874974835 1.2418189298366200113 9.7354228435577301326 0.22684731102800295699 -1.7699916427414359443 7.0313827166788991363 5.6777424527108397712 12.66615891156728857 -3.6099073054548629358 -1.5942396338680786538 3.903240258519374617 4.6611520691075138956 -9.4205945472235761429 -2.4192283934467564421;-2.9986764993130643475 1.5192198172538748935 -0.76875992835319761909 -0.29574954745306736292 -1.767313415125520315 -0.16078713971907665492 2.0820722121552743822 1.9875560880898790472 -0.47570067068011995248 3.4137024144480414556 -0.055974012821118662719 -0.12251365340533017234 1.2593766568825237595 0.47420501719523605599 -0.10159598963128452231 -1.5585311002089583532 -0.19093500156835430115 -0.091400770576678030954 2.1287056964799182524 -0.64488763762471923435 -0.11350879027673300981 -2.2501935715104828262 -2.3294666104261527728 -0.050735947080708748702 -2.0521451311692358033 -1.0686090835693844436 0.30982515730489068595 -0.97808893619903292116 -1.3830263687358217428 4.7476008278580081878;-18.45336987841972487 26.766387803640444787 -2.5150890194136135136 31.107836309582356904 -1.0065597830098877985 0.52053279026429233323 6.6908367548151828075 7.6677639573853557664 0.71279122656819915438 18.082237289648656287 -2.8951054248720944351 -1.1734142367813726882 -10.465857130860465318 3.3482237737861684224 -0.81075915836898759803 -2.6646795994291103682 -5.1225755900890366235 -1.6841603890173029168 6.6977601557201520421 -7.0634572827421546748 0.15052478919740902574 -7.2425649475491358231 -6.7335759982126708323 -0.41435527021631113342 -1.1948662084898742375 -3.9818840535402109104 0.092304437588110327395 -9.6531499891822161175 -20.399794063590359627 -5.6530842054923962081;45.077930096598763043 -96.420065263424859836 3.4970406593065979095 7.1017285007250032791 26.241629883219705022 3.337767990749741287 102.54673498086127381 21.43822543746787801 2.9095932014055967407 -66.028980398050705958 -3.5435354446887568081 3.2445467800771798927 33.767741707672008999 31.765351254978625661 1.1447634699460647045 30.808911628005159145 4.2103229745069592482 0.92930224103183201034 -97.508686231830822067 20.006424478751441143 1.0334227010876455566 -13.0083618927671818 -63.119538895570585169 -39.095929503774122793 22.413690138506222382 -64.725935678638194304 19.419715277320861446 -47.270229007323770531 34.735843150441247928 -1.7592223767347821006];

% Layer 2
b2 = -0.44599295642319658484;
LW2_1 = [-0.53657597231354503542 -0.80117614127706571203 1.0210296957996172207 0.95975140512995316122 -0.37777054852901748028 0.7583559349906466851 -0.9597160861372111551 -1.2287583096916270264 0.16665961935511353076 0.35699914050451453384];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2;
y1_step1.xoffset = 0;

% ===== SIMULATION ========

% Dimensions
TS = size(x1,2); % timesteps

% Input 1 Delay States
xd1 = mapminmax_apply(xi1,x1_step1);
xd1 = [xd1 zeros(3,1)];

% Allocate Outputs
y1 = zeros(1,TS);

% Time loop
for ts=1:TS
    
    % Rotating delay state position
    xdts = mod(ts+9,11)+1;
    
    % Input 1
    xd1(:,xdts) = mapminmax_apply(x1(:,ts),x1_step1);
    
    % Layer 1
    tapdelay1 = reshape(xd1(:,mod(xdts-[1 2 3 4 5 6 7 8 9 10]-1,11)+1),30,1);
    a1 = tansig_apply(b1 + IW1_1*tapdelay1);
    
    % Layer 2
    a2 = b2 + LW2_1*a1;
    
    % Output 1
    y1(:,ts) = mapminmax_reverse(a2,y1_step1);
end

% Final delay states
finalxts = TS+(1: 10);
xits = finalxts(finalxts<=10);
xts = finalxts(finalxts>10)-10;
xf1 = [xi1(:,xits) x1(:,xts)];
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
