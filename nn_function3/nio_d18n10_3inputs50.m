function [y1,xf1] = nio_d18n10_3inputs50(x1,xi1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
% delay 18 and 10 neuron for rupture 10
% Auto-generated by MATLAB, 10-May-2019 23:12:35.
%
% [y1,xf1] = myNeuralNetworkFunction(x1,xi1) takes these arguments:
%   x1 = 3xTS matrix, input #1
%   xi1 = 3x18 matrix, initial 18 delay states for input #1.
% and returns:
%   y1 = 1xTS matrix, output #1
%   xf1 = 3x18 matrix, final 18 delay states for input #1.
% where TS is the number of timesteps.

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [588;52;0];
x1_step1.gain = [0.000550206327372765;0.0045662100456621;2];
x1_step1.ymin = -1;

% Layer 1
b1 = [-15.715312200859862912;2.6748711529141115939;92.039923649157529439;8.0562473733740134207;19.557479565646449515;4.2024450042617882417;18.868359118359048665;14.924536969973539513;-16.737505619738758611;0.52557490278462903888];
IW1_1 = [129.28246610124185167 -54.508823510067031748 3.7803610375046297065 -112.20164223137859949 52.089147170874255721 5.8355734671614705178 -12.146073917383573004 25.745239580373731059 2.2874902094339342185 -42.407588032394215816 -3.3883341369929569353 1.6649066936458620791 -2.0003122823477288428 11.566415997933823689 2.8297912106001752441 4.1882189037830048761 -24.458451591178150153 -0.66582918939128843405 0.77643005341717818979 2.8973597523999088388 1.4852562047530952771 25.414669959977246094 10.305757254962419012 3.0402870447124756836 -9.1863757421301421857 6.6941758831951947428 12.70007451261422915 -0.13796198054740838046 2.1338963688299812382 5.3171728792448620382 -18.915624568564084029 -5.5001305405533322812 1.2522529874082564127 24.631697014119993128 -2.0249261075858520087 2.124100702151102471 -51.116719281660714103 11.371876045299154967 0.55503095438203209344 41.39893991923889871 -0.93547829031943718903 0.28434483267672827633 -7.7304320335106435635 10.990158105484340467 -0.36564237640230562443 18.514597456835261369 9.4698005441877679544 0.23514177518445938952 26.911022579506774122 -24.15561425986241062 0.26208442967702011428 -22.065698250050825635 3.7976091535784965991 -0.49351326140549317545;29.135436722459832737 -18.917803224628524816 -4.6519240976680968913 -18.689164377026543207 13.747777016187843202 -1.5340326497828291608 -3.9939325250530157696 -0.59293773038513020168 -0.17055128113428402736 -5.3279787278356325331 5.6547242443020291347 -0.0046241273802184179598 0.56953058071404694118 -6.4277044543490546857 0.043116949300181166282 0.044159347368707635439 0.0014322762917031717222 0.038972034786086809377 -1.2095965420039824778 -1.031630690710387821 -0.2253324787932137474 2.980328590349735407 0.55082152892953883949 0.037175310339230903389 -0.64944383843556119373 -0.2131673829263108777 0.27946110122348749583 -0.76776979702464687172 -1.7640766956156983536 -0.32919061433362140079 -3.9097035729535263293 0.66533329977890132145 0.32860506361416180754 6.4656379014813181172 1.0593852398654455271 -0.39946329214862924539 -12.650736629133211508 -0.28674593866125652752 0.016176635072287132849 9.5545039477808266781 0.10847381284495122289 0.039520410490804895598 0.1748872563663217139 1.3560280310525678615 0.046597258381239042846 2.1080652097249696908 0.60961399763661561213 0.035903402586897996407 -2.1805230193841387276 -2.0108913248162370024 -0.081718892183517063965 0.3395447066471555253 0.99574461072167974596 0.10364262855740602465;67.559182553201281962 -41.290568106003092907 -45.837304864024375206 56.077726468029702289 -37.102872872585329844 -10.39584610999147074 39.631166303184123478 -35.357148475356403594 -9.7471663778397310551 27.820813605294645754 -19.309086565617349152 -9.4485750064856812713 -5.0012422270061538399 -13.230430084412724057 -9.4463537656888583172 -44.6697967491430461 -3.702000283825067406 -2.2609251654552751098 -21.190068908077954291 -5.4663768268406958128 -3.8130420819187254011 -53.461076137082088167 20.21513278271470071 -2.147173273704372054 -53.623088569684121296 23.790274148770393481 3.5561843036144074048 -50.449795073372889931 15.367212649718215545 -0.827008211725880793 -34.861492498413952035 15.766682318327672974 8.246954255056847316 -15.411375145930689357 17.874575283219819255 9.029605911136130203 -46.504943319519426836 33.609084351063302165 -0.85571412406802815909 -4.4318721608136062429 27.206864561429096483 0.15235019871600669061 13.319218724316868929 15.735156067130334989 1.9915202786963970283 21.583283398607512993 -0.24107084502625097944 -15.146772353675856948 39.215726148328748479 -5.4375505416754688071 0.33263990094080098103 65.726657691519662308 -5.3160645372923180929 -0.11639715520782087377;-48.00365594524142665 12.361373984260319858 5.2198741350943711481 24.385180921842337654 -10.063011410537711754 5.8705031359652704026 -5.6624272239703064002 8.6912544753344960213 0.87697334511048563588 4.8242740778463959472 4.2521763909767100742 0.059165298666904647673 0.16061667469470153335 -8.7922478214690933385 0.013729210423539819907 4.5366577011667406083 5.5081961391539788764 -0.40313742568518168286 14.376979895994807634 -3.4718909403636137867 1.1783104909171591146 -1.6239309449091525739 -7.2898717683671820922 -0.22254654998043882363 3.9998327056857152506 -0.3241147454209859502 -0.57997973257932067259 -16.89714177532557926 -8.6413040504626046356 0.29385822925052351717 3.3395816799601032443 6.3579762096122358628 14.482392926749470874 -1.5896830194253448454 6.6789057603132704344 -0.49184788821932545755 1.4671779543275371704 -12.697393440163136091 -0.069660285995668494441 6.5312217423840843722 6.8702808874448537679 -1.5877240754527213173 9.5139469140561594429 -1.2800101897604247991 -1.7527307000456175956 0.29355887635570132588 -1.8855827501677080438 4.2526442588969697312 9.5155499929696922834 -0.10023537390671588554 -0.38470525948673395256 -7.0781351772932650235 0.1182508480033577225 -0.73159781993834616109;75.723368372571428608 -55.10876093705590506 -22.948913282723651719 -1.5165412413882011222 -0.67713348131886585968 -8.3985889984646870943 53.02700321567487407 -18.159827895925321428 -8.9182862058046854514 9.7665926295474676522 -12.77992733692969729 -8.0294932150229527679 -28.710790026953716847 -13.551845397869865195 -13.07466349486821322 -1.6122101901711785032 -0.60683245482904224488 -3.0910271238407993621 -40.334303905218369835 36.343212253524747268 -5.0844842763980828693 -61.622599112438770419 -5.2187037435001091268 0.7080456695670879208 -12.766689171141113235 -14.531703466392723811 0.086094311031065420825 12.797481178826139114 2.9511491031495538095 1.0492227843579635671 -0.35512987528318329389 8.5658522958092593313 3.0632808923418513025 2.0308637715690149861 6.8756265516560812756 -0.48540615275878101764 -41.811229228009430869 -3.0116623227121142037 0.79938975480321039502 16.176679271080221412 -1.4123945699634052886 3.4321310646561240532 7.7080442188500395417 21.41852058348564114 -0.04301535322727600974 -22.082834704213485821 -2.4825051227956893563 -0.60823467237151696008 10.88897830431966085 -3.7152612327831886496 -0.040673719226179856634 34.550030759239568567 4.9442645901035424671 1.0255323493814418878;38.998312873843744342 6.9468938468658967267 -2.8848752195754174821 -25.923370132219812234 1.001018656156518194 8.1897022395001588535 -3.0879381728722785638 5.312968193554972629 0.3134260033853757399 6.0064721576358763855 -6.4897831244358634706 -9.0525647816260317313 -5.6123136933301482898 -0.62053230556515504013 -23.876278792732104961 -14.193739003692817491 -9.8869400383767889195 18.354625451127386526 -6.0843884019430225507 -0.33379763035112675063 18.649870178806580157 5.6359005068792846771 7.1016888795851347282 -0.040201557019314278218 7.0309139400422120403 4.9932321762468090398 -0.27360968610437047532 -2.5770393571342258277 3.8141879837018333177 1.3302130227526691719 11.654023401658616166 -5.7971879281136828865 8.0516214977499469541 5.1393643174132312978 -3.1180439847527479102 0.24802038905695200643 -0.31635823766971410409 -2.4165506405477912288 3.3816666627548022106 -7.7247163458658505419 -1.8104811217241019161 0.78563848955959736386 -8.8394018588590768104 4.3089104156820923208 -4.3467912347026294029 8.8648278334511232401 4.4307243899732622339 4.6327121918621188001 -0.49495237068233444155 -5.41201032528090753 0.83255108366183017132 -7.447909618940972365 -2.1639163111144736895 -1.8420811645614540986;27.240542947039077859 16.926144320849932257 -3.54514928693686171 -25.872758296963983327 -7.3022803034278851442 -5.1978462715429882834 3.4080288110096290666 -18.179867033596824655 -1.9127297236645175449 14.095736374330925855 -12.908885368544828154 -0.86582821628295048022 -10.389177544684757848 13.050142420438145763 -0.18376944634052097549 -8.7341413704537202989 1.4975081089512152221 0.42616717195052156164 -2.2228219708178365011 10.490892077039571717 -5.1519020293349413464 -19.389264281594527972 -2.2636516267995197005 3.215776359652113392 2.3408863244568576256 1.4911819782210704588 1.5717270957301991974 12.415670475955099761 3.5585773782192453574 3.9554805302121081034 -7.6533476376372053807 2.15512846511564371 1.0668594845770134061 2.9608155410692642562 -0.63017139857956228077 1.5410352068679913362 -25.070838230665994928 10.20977368934427254 -0.25415463172117269686 20.306737148022868666 -0.27783612383442929383 4.9319679955983115605 2.4723618735651688993 0.51020660163440822998 -2.9403960526914629803 0.82980447559720404982 4.274715077133091512 -3.4055334370166772118 13.291752821465276924 -4.8415462583339472502 0.13306199195445908567 -5.9560456417376386185 -1.4152541768625579444 0.047737856579118068123;44.116686303000548719 -40.776083262292559084 -16.669650509833548568 3.6995043809597092377 0.81820345501432156787 -5.6441732127208421588 3.1651687923156441862 13.921635683459939514 -2.8565452603275858223 -8.9943361318791783532 -5.1729705047159475484 -1.4432358502358884067 2.1605247123559219169 -0.01756266291966745996 -3.9205383708833880796 15.232771576494274157 -2.9019084063515423466 -1.878143177164499189 0.56806979891299702601 -5.040618416717771666 -3.3167076587202841687 -28.210287634892836195 19.580772258295198185 0.87492378708032092494 5.2172780745833335914 3.0455081140756763425 0.36714614366405695645 -11.431422520745949001 -1.9637765382431719985 0.58364974721153806136 -5.4526755390937386991 3.1544253954022440922 1.2942216727402942045 6.4012568809009282589 -16.423465026427020774 0.09552359672672935953 -20.721802312731142592 16.344675064693149125 0.19608671597009993959 5.0357432585013803816 -5.0216197770635062625 1.0656731608766878416 -5.4999638095980571961 -2.0514609593476245131 -0.25109873150443734469 -9.425435901221110413 9.6751784735925951964 -3.10814900396750593 -2.3238495327400823243 -11.133713795523178192 0.49393116936886533042 12.493491619088995748 8.8346541975647596701 0.24305214643812877995;-48.287268799357441651 39.286144254125787256 19.168286721759301372 -40.370403531243120199 20.282527825474680583 8.2093955884433942316 -14.328058186168714627 9.8629775139958582031 5.8213250409908399163 16.062878746068676605 -4.3155044094931440668 6.1557548046532941655 35.248153164577367136 1.60106733033531623 1.2572249829571240376 8.5863292556159436231 -10.833325439671813939 -1.331042935819582107 65.306368787197627057 -41.70666950615334656 3.4871329488450895084 32.114541022683276594 9.8568147416948868056 -0.24810223746966683644 -9.1117194248916746346 18.247251208492791363 -0.099205589279740546971 -30.301086888237406924 -0.7884497007489734699 0.13134720621277568009 -16.174917637705391371 -4.687867627629620948 0.080134485705085606311 -2.7781928991858579892 -8.0313147937331823556 -0.0098819919801165050088 3.4023753499618298868 4.0022891520334127335 -0.035467835215963014472 0.28899239453328884331 2.9489165204363576578 -0.081116910577211806532 -4.6988959281076336794 -0.78824548700181429339 -0.33595810463598918538 4.7524867121656599878 3.4405653933991557913 -0.30018461937011114982 -2.6240304522046953295 -9.0579457785460935071 0.10132570864421930334 -3.04565358986373802 0.39103936010520595756 -1.0239622860135095817;38.919238878750377353 -19.733053264189319265 -8.1541457448534391261 -22.34280405825043303 12.74392360517605205 -0.41802417986936091232 -10.482650646256860938 -5.172190819768453629 -0.15487729021495930115 -0.28920045830985907642 7.1815191284796160431 -0.10108455260442832102 -8.2039953834652763476 -6.1597722565831061203 -0.067634161572777476423 1.0400767786882232357 1.2689336537862363485 -0.15680792186964595536 0.54818442959120439184 -1.2855440103582522759 -0.42883001892380401276 4.467221427349629792 0.18899329215820626082 -0.27733398127759795182 4.4986305677771678546 -4.1824672362096126932 0.22946574815729312014 -0.60607778732061445837 -2.726707972615461717 -0.24821270662394590012 3.3657532564730345825 5.8619537351046204776 0.36034987198553075638 1.8037315729373233353 1.1137453743580187915 -0.78141034971915845908 -20.618325467073731261 -3.2727857918415366179 -0.084128417687037937434 15.182648146158552294 0.43731044353253434309 -0.044123211966345068924 2.9475882101595112239 -0.11005904650869680061 0.10160902999158148707 1.2115121239690904709 1.0433946567373140191 0.27785304111728492682 -3.4421689144371736546 -0.87021835480303955102 -0.040410616242208985405 -4.3275548941579362605 0.73166016748666762304 0.15500318513201438719];

% Layer 2
b2 = -1.37021456172223699;
LW2_1 = [-0.34440516627993522647 2.0161288971123716429 -0.79420189421261710994 0.73167823915602514528 0.4181560497839756918 -0.73215695478370612648 0.65255091363308370678 -0.66078452920208707866 0.64259602348687960838 -0.96379154654315746242];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2;
y1_step1.xoffset = 0;

% ===== SIMULATION ========

% Dimensions
TS = size(x1,2); % timesteps

% Input 1 Delay States
xd1 = mapminmax_apply(xi1,x1_step1);
xd1 = [xd1 zeros(3,1)];

% Allocate Outputs
y1 = zeros(1,TS);

% Time loop
for ts=1:TS
    
    % Rotating delay state position
    xdts = mod(ts+17,19)+1;
    
    % Input 1
    xd1(:,xdts) = mapminmax_apply(x1(:,ts),x1_step1);
    
    % Layer 1
    tapdelay1 = reshape(xd1(:,mod(xdts-[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18]-1,19)+1),54,1);
    a1 = tansig_apply(b1 + IW1_1*tapdelay1);
    
    % Layer 2
    a2 = b2 + LW2_1*a1;
    
    % Output 1
    y1(:,ts) = mapminmax_reverse(a2,y1_step1);
end

% Final delay states
finalxts = TS+(1: 18);
xits = finalxts(finalxts<=18);
xts = finalxts(finalxts>18)-18;
xf1 = [xi1(:,xits) x1(:,xts)];
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
