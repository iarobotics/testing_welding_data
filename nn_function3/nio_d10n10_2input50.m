function [y1,xf1] = nio_d10n10_2input50(x1,xi1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%50000 samples out targetting rupture 10
% Auto-generated by MATLAB, 10-May-2019 21:40:46.
%
% [y1,xf1] = myNeuralNetworkFunction(x1,xi1) takes these arguments:
%   x1 = 2xTS matrix, input #1
%   xi1 = 2x10 matrix, initial 10 delay states for input #1.
% and returns:
%   y1 = 1xTS matrix, output #1
%   xf1 = 2x10 matrix, final 10 delay states for input #1.
% where TS is the number of timesteps.

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [588;52];
x1_step1.gain = [0.000550206327372765;0.0045662100456621];
x1_step1.ymin = -1;

% Layer 1
b1 = [15.46692374988458063;2.3849896168588591294;-15.829755251334587385;2.6275120153585054261;-2.4905556631545540114;-6.2770895773256070171;10.62463494956097243;10.213338955513535211;-5.8239106242433296146;-6.0584431764924433494];
IW1_1 = [-8.8475961377649205986 9.4449177297648656548 -3.9449921698796814873 1.6130954278824103376 -0.36684306709896985499 -4.0048417452239304382 2.5444237617158593778 -4.1776366518359049351 2.1155199629222596336 -1.6612768127813279939 0.1194586341650805128 2.5864961910474604245 -1.4769432849802428542 2.1195701496129975006 0.2509665251248526241 3.6375034162522039693 1.3324351720567748636 2.622500971950200821 3.7966571109210116575 6.8416107569405664179;-1.2114949524459490693 -1.0884086731597575337 -1.2256204634469227699 -1.1729587107606509466 -0.73690484674020984013 -1.1021324523211213364 -0.73157505378653420181 -0.7751267819059945996 -0.42638735903716440401 -0.71699509185823151469 -1.1647916775501196973 -1.2605184927087429436 -1.004951241161899711 -0.31845192196787663885 -0.67661440046847742824 -0.18949548822651549052 -0.55476648750640678021 -1.4636810983737846836 -0.47779676617238892034 -1.7015167756117286491;9.1312611926228495207 -9.4728917057589097084 5.0321160764205634663 -1.6657574593286017528 0.92002350426402201844 4.1490360186515662377 -0.66708063029678010825 4.0346956575437848969 -1.8063053671640088016 1.2926494347923302985 -0.52296762505634020179 -2.1419026367042084402 0.56360927926640314034 -1.6509452676400804272 -1.2341660469823683144 -4.5106174777289220756 -1.6953608016940793224 -3.2601466352285388695 -5.3990189858761921116 -6.0064105849857840624;1.1393781572648093992 1.2971191362660265955 -2.0447920984843102055 0.85973285185915304663 -1.170520584164222111 0.13385838304369296337 -0.091644367752428693152 0.2543764999039181407 -0.13700881076970400363 -0.018057370826052770996 -0.39962952468361073732 -0.35873399166962793849 -0.57545827346291467119 -0.68604302326672095269 -0.38839930267160327482 0.10006537964146902664 -0.17999682839576758298 -0.14271687810327171597 -0.04224415071577351799 0.61134145612762447186;1.2192863207937270076 -0.22006551654501116388 1.3902538403433699621 -1.1352492820617812175 0.86661181064090608839 -0.38790706645588324264 0.98057806874058106583 -0.19214222308801759409 0.078262781631626851531 -0.74301235144269406341 0.36777419077778650269 0.0032782465769575913628 -0.2708170253540388428 1.1567562733839649169 -0.066255077346844826192 0.4124315903659763749 -0.1841678181469738329 -0.50617447766645529139 -0.052722654647608557799 -0.09082780972833622013;14.899495694550104474 -9.6857759197027650799 -5.6948449390880746535 -2.0160294941834173699 1.7658814887004026239 -3.4184650391525450708 -2.8930086588937502512 2.4284255842668653891 -3.4328137968245755474 1.9446327333220079225 -3.104446935121645712 0.9635477164614392187 -3.1468814412306342909 2.1762196884806894737 -0.85077793176803095943 -0.32978373689219864229 1.439591188608697836 0.97382277028983388334 3.713222962409294059 -2.4280342559903966837;-20.199165558803834131 15.400041184353842283 -10.199051511938487025 5.466948998739172616 -1.0204935322847710211 1.7727833347791444041 3.6613913662741768285 -1.6801634410662451558 5.8844080898293249504 -2.6540626931682806955 5.5400482392897405504 -2.7559134082135279264 11.399756468166023282 -5.8898935481874570286 6.6125597852170523439 1.0847951265382411723 -1.1757495832651483347 2.3804156156135167777 -3.2885089143292423053 -1.3621723075686225091;-20.039760087322555648 14.819606972774963083 -8.5551651931251129213 5.0264059910243030771 -1.3083684591799740193 2.01536189565433288 3.7064840252615169902 -1.6094534337246748645 5.6711417277175470986 -2.4952548099774265467 5.4723795783513038415 -2.603137955172994733 10.876711526979516265 -5.7010438928018070115 6.0526891003875986641 0.88433565135680858305 -0.87961525137924023721 1.9898258493247129586 -3.7583399156886350134 -0.84038354179528040877;5.2989610749963267367 -5.0246583558863031627 0.19526244547890161951 -0.49983523922185424393 -2.0275800462640796162 0.58820484112492676942 -2.3567656512409684844 1.2671600407041019309 -1.5102545230714321534 1.6491274279472745157 -0.959401483691976531 -1.6299220859549350404 0.66862757265249128658 -1.2943208405610893141 3.527398077260096354 0.59495647385293159992 0.31634829090179350519 -1.161455316948494465 -1.2021094371625622443 -1.2209792297504478142;5.0295922175354421668 -5.3277432804899831353 4.4643570186718273263 -1.7375008055385949834 -2.2948906285967245466 1.2957271495955149376 -1.225418224942866452 1.4441837614372003973 -1.8538313227585063725 1.4225499925569211612 -0.85387411087287845568 -1.1576756550254614364 -0.71046514926791459743 -0.6966951414942557097 1.2220217670001995991 -0.18551905987535480258 0.74533212601805542974 -2.1442644740198333331 -2.8686730675526499468 0.64112968365391620473];

% Layer 2
b2 = -2.3190633180151190018;
LW2_1 = [6.936652851520427987 0.27812749700727318336 6.94847170646859702 2.5415860075593106338 2.4615006006536788163 1.5345736033361061512 -14.836898824086915738 16.064920568237223364 4.4648399295723946167 -5.7442018173434004069];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2;
y1_step1.xoffset = 0;

% ===== SIMULATION ========

% Dimensions
TS = size(x1,2); % timesteps

% Input 1 Delay States
xd1 = mapminmax_apply(xi1,x1_step1);
xd1 = [xd1 zeros(2,1)];

% Allocate Outputs
y1 = zeros(1,TS);

% Time loop
for ts=1:TS
    
    % Rotating delay state position
    xdts = mod(ts+9,11)+1;
    
    % Input 1
    xd1(:,xdts) = mapminmax_apply(x1(:,ts),x1_step1);
    
    % Layer 1
    tapdelay1 = reshape(xd1(:,mod(xdts-[1 2 3 4 5 6 7 8 9 10]-1,11)+1),20,1);
    a1 = tansig_apply(b1 + IW1_1*tapdelay1);
    
    % Layer 2
    a2 = b2 + LW2_1*a1;
    
    % Output 1
    y1(:,ts) = mapminmax_reverse(a2,y1_step1);
end

% Final delay states
finalxts = TS+(1: 10);
xits = finalxts(finalxts<=10);
xts = finalxts(finalxts>10)-10;
xf1 = [xi1(:,xits) x1(:,xts)];
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
