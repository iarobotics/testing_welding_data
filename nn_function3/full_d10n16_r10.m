function [y1,xf1] = full_d10n16_r10(x1,xi1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 14-May-2019 22:54:43.
%
% [y1,xf1] = myNeuralNetworkFunction(x1,xi1) takes these arguments:
%   x1 = 3xTS matrix, input #1
%   xi1 = 3x10 matrix, initial 10 delay states for input #1.
% and returns:
%   y1 = 1xTS matrix, output #1
%   xf1 = 3x10 matrix, final 10 delay states for input #1.
% where TS is the number of timesteps.

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [588;52;0];
x1_step1.gain = [0.000550206327372765;0.0045662100456621;2];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.3113980127649311758;-2.430193039216385742;3.4423429452727911659;4.849291445122100086;-1.6546250572870275786;-0.99253168207304987014;-1.2764089150987265597;0.43291193355008555921;-0.71762054603371894235;2.1629017060413415763;0.89769102796284794277;-1.531579360294683223;-6.4072391223550964057;-1.9594912216904396551;0.95515020095156499824;0.44957529394436723802];
IW1_1 = [1.8279679719899497581 -0.79676768840254785786 1.7583970623468685446 -0.24954322314265839355 1.3557020866863789266 -0.92646102176853384336 -0.26527217062514102386 0.84288004663809767969 0.24915041532008982972 -0.43957453924247330557 0.66232388402478092893 0.016133807643559292672 -0.39782207574004369022 0.031222608478709341917 0.29337734802049048044 -0.59645819915126885302 -0.67268380985548892337 0.086166267595436940585 0.2336020531530846045 -0.7298399732122555772 -0.60880630647906197606 0.4786459506152773713 -0.77378891499431190493 0.29665036268276473441 -0.17180356592699583262 0.23348756641169118864 0.57014563907725601677 -0.2117630545630199701 0.36356870863391688165 -0.5073064764385221137;-4.1658432902164781453 -0.28122801570561967166 -1.149337508712556799 0.89448444452432906981 -1.7438908746778951642 2.2032331240889582169 1.7695274795187678762 -2.2206808569401821352 -0.13481007331082284217 1.317975154164866991 -0.71748189262355754892 -0.23030011947918932469 0.42912171765501838649 1.1642354250993509623 -0.25890801154912224114 -0.31127072518159293324 1.8504171388457080205 -2.5765098650960740478 0.14514804344107379297 1.2625584555909195039 0.24662976722434906685 -1.2739894077384230631 0.82687321829452631317 3.5415392671459047236 0.37052515825339132904 -0.077487878111598712527 0.77778547344566650867 0.33162087195761319469 1.0538107742494937646 0.90881360799230337388;6.8080381730347223623 -11.539019488803218039 -4.3998433696943264337 5.1905117435663443715 -3.7705103389810687986 -1.4317430678470910443 1.9873473768401688222 -0.1674192316802795566 -1.7139696936012276396 0.33577448363429623912 2.2561019999245965906 -1.7377910655579100752 -2.3726030496976893147 2.221995465569511552 0.46508764639366217963 -3.2689763519314314344 1.6356210920716223178 -0.59382354781220336726 -2.1266704442578641121 1.7599740454302879034 -1.4023649979257990505 -1.4385852547159618808 0.024567704696754913418 0.25212715143623987135 -1.3371640970632501233 -0.45367323355899957793 0.33911847364959674112 -2.851463638819624169 0.15022533943421859104 0.2001489758294812682;4.2433055594525805887 -8.9480085143303362827 -3.2231331083188416997 5.3608601541849960626 -3.7765046231496479656 -1.6387167671726188267 1.5747179859300290961 -1.7277887217768599371 -1.6299979708192968708 -0.3650156767318333273 0.40466870011095457116 -0.71323923002428757378 -2.3740135220876577016 1.0477727207320184366 0.030937094760793024117 -2.0412854160743783005 0.48993234822656622773 -0.64399628903424810389 -0.92827804256725254817 1.087628578161569548 -1.1501115935536960766 -1.6237241578462353608 2.4403036926119714423 0.38330305456650870521 -2.3115914749023565022 2.9354368086742126387 0.60687800993162266394 -2.8164736418226894443 2.9683090206903957053 1.2034667623837853601;-2.4489752830108844073 2.2649550802171614095 0.10294923677821878061 0.0021625367701618514529 1.1589918667772600713 2.71391632709720243 -0.25168832108902106093 -0.24893560134465891887 0.40259336457040606483 -0.80317885107225328589 -0.09288353221225323364 0.21612235503714155582 -0.10230934651723710971 -0.16730537320271937629 -0.048484697537654129762 0.083219963345528391585 -0.76070386095070374743 1.7971871392892426744 1.0492377244140831394 0.048063934025758668633 -1.2885178980075966404 -0.046078248573329698423 0.52667956952180150498 0.19001685310541469032 1.2944113754593260524 0.12154866161189237239 -0.14385712452647814175 1.419219872122776005 -1.0588140373085921375 -0.081294122723590642177;0.45332569722481635965 0.47718901647820205492 1.1022305575110271647 -0.70370073142794120624 0.028583410705791349044 -2.2841850945775479254 -0.57222794021444589596 0.071048464360821475538 -0.2850221471554171826 -0.10898089945520468558 0.18605268872566546601 0.056466645149498798095 -0.2425591377578579233 -0.15059467207554330659 -0.26148996994648227021 -0.10174167159820697581 -0.40441086504345030717 -0.32907823152584014803 -0.19148304572698718329 -0.019642660354133440609 0.47694313756115219727 0.77975186699956211545 0.060455444649295662918 1.9563709479966704397 0.31941506421709375818 0.33854261274434244156 0.41414475579449894216 0.42180562117228004304 -0.08887735843834940197 -0.44311502997950658056;-5.057866910911349656 2.7033851384120231032 -0.54152865232980840204 2.0680518709416295664 0.77053965443436966964 -0.089046968535306733616 -0.6556364814185113854 1.7987205804893389161 -0.48268517773880359467 -0.32582956141267882533 -0.36407544666265362343 -0.011597561211620133897 1.1776510630749177366 -0.88646416789183679619 0.25063430918915391432 1.728865322136944549 -1.260772099233083976 3.1316047957342911801 1.6357397106027480316 -0.35922498850281431304 0.60747624045516468438 -0.037158425045040847923 -0.035468424391016058206 0.58405292457895086056 -0.32403552423311898778 0.23548795518746032385 -0.14932431438386159495 -0.43951736390963219714 -0.58505264860310046693 -0.85631785011070016278;-0.21613710831304733251 -0.067449750520712059565 0.73830296361821567963 0.32454890267328295739 -0.20724309416652517135 -0.21515254209510006889 0.43223097474407357055 0.11407116984616083588 0.11501005723781317081 0.17313763027741840839 0.80656158989865878173 0.49597128871113499438 0.70491569267001397137 0.062273266951254575841 0.42574030075169055909 0.06239128296995927192 0.25596388151647120335 0.33656071346052118809 -0.072112189633617165829 -0.35454994825200869535 0.34329992363784289644 0.040441426557887218129 -0.18456736195378836696 0.95046846528720496661 -0.33491138064862313595 -0.88362962346317264206 0.33889108993132183167 -0.14149016993106669493 -0.11216248572084776269 0.42780869867826137876;-0.96376641200072332705 1.8056255053304774982 0.030058999754575255886 -0.20209422705592053338 -0.26578952359558571938 0.68271405761070969032 0.21621086936561212388 0.03974622547322439331 0.10773272461697089297 0.018114816330437624042 -0.48101378464511707067 0.065981843819209323732 0.16885813291958848281 -0.58563779187262376968 0.29443321664768562496 -0.62299567893725160683 0.10125026849592200229 -0.47905568964304329205 -0.0029987027134694864069 -0.27031410494397339894 -0.72983134205679134343 0.1849715254176585999 -0.58009518900112955198 0.50353678960303915879 0.14724054325609609029 0.40893816816373723677 0.77991907686783856768 1.023158702986954216 1.2283855811405632874 -0.22274962512955284732;-0.35447408323743789804 -0.6752414165706458471 0.68914308443158411865 -0.36809551662370987302 -1.0158759333526097279 0.28304995364437091077 -0.063904001572199733983 -0.59156194855441113223 -0.21825326750206669457 0.33064919934750136576 -0.47477258812150668899 -0.11080320328201347102 0.14614223826470215672 -1.1675396247000191519 -0.3872276744026758033 -0.26009463789221587415 -0.53042590609273543301 -0.76166162448683338848 -0.73377404128499779112 -0.02098033879299719684 -2.3569488342269862002 -1.0264570766752847408 0.10355555667456689539 -0.35473529417689564358 -0.88710353284775611549 1.7682245450314462154 0.41948843504309063501 -0.65036516520325182711 3.2557165743564469018 -0.19763100692243981693;0.10681617405722464154 0.45069346454494607634 -0.5942475387093314465 -0.43501317830094082817 -0.3278760066622624092 0.29668220874407008614 -0.12265675019008337454 0.12485534212649802843 0.83587670868490826503 0.044130388433919830182 -0.11509941222082395451 0.51280753454218130916 -0.1366382747906202122 0.29612461279819146664 0.17062083412542616845 0.4163008558516268498 -0.18383408209525753385 0.75765025836240129653 0.22313314127970804157 -0.23964296008856905695 0.68553082305169832367 0.22249949709977917545 0.089915915198897508609 0.49260128443944023457 0.64312341385733984289 -0.49221877403004998808 0.044976984585953096174 -0.067213688222640705083 -0.20231680427524478816 0.13785946715431762755;0.078341380223536108418 -1.0340902405529468489 -1.8527049081054409729 0.60807662461348732652 0.056646969437723126983 -1.2030890872632475919 0.24291365223191538347 0.099665219286581563374 0.060055726862009807532 -0.09293475776529647181 0.098060427371876049407 -0.081509675474098264303 -0.022138196332681596423 0.2849848538418591759 -0.13715725662773670113 0.27237286280722744491 0.12131697513420186541 0.20426530597523381849 0.27894087520302801586 -0.061924228874092206165 0.47134982922315760145 -0.54439490221561936956 0.10086756156168903698 -0.24744818615706012932 -0.33899565800535319537 -0.30883712290549053536 -0.43587699039317751026 -0.57044260489630294053 -0.2476136630859251675 0.24200329564877115507;-17.447110164013984956 17.482428824294082403 0.7318455856915399016 -6.7930148947167650064 6.0651313811581415436 8.4829895439940337099 -1.9939842231420241703 1.5975387212605760556 2.1199638140700094446 2.074019100226085488 -3.7998336911438150842 1.9588867850727600395 5.6040789991747512744 -3.3700579588714534296 0.37823931748955907928 6.2061608254432840681 -2.5676030460599887917 1.6935061706087941591 7.6347728922790230044 -4.2430013699723918563 1.9149104666332714686 3.2448575440449567431 -0.16116851638612050834 -0.315041772890204963 -0.017714929901033779625 0.90207838218436087185 -0.40558917842821762267 -0.60993638949650041958 -0.12414539312726126374 -0.34734972561373583799;-0.93263943543945881931 -1.1973165232343156994 0.84333814481390911855 -0.29181982404129425124 -1.7622284230594882359 -3.1441516948431855738 0.88174332248177200722 -2.0463624136549487531 -0.63988976611407977213 1.2466738930721552592 -0.5724953278310261906 -0.30922548027139151738 0.35521441600752451384 1.2494113989339898918 0.19575858776306181985 -0.57484915056192398275 2.8624424515918347467 4.4261126924985836339 -1.2490489598381733227 0.87921471119194605226 2.111954020591069181 -1.1602649614082773954 -0.050970631687426437573 0.16781968909432537496 -0.88971868348068494647 0.6473639213794630809 0.17249421991164964885 0.32231300323259692853 3.4132454299013539334 0.27154329829318418765;0.60539763562673543085 0.81800530396370718655 -0.31753433536077235733 0.17262295196549989895 0.39090623038609240147 0.057390105108733838191 0.15965566844161854787 0.0080902289521173204045 -0.087977378566877290078 0.24687667051055123268 0.21688458731775731025 0.29290542984578993302 0.13729138884868391512 0.43922990599808225953 0.10475221227740344476 0.0013831118221889534409 -0.28335761685121468867 -0.043363015781303207441 0.53427943132076372024 0.021219847402054070606 -0.32810567163379522615 0.51797235619174875065 0.087469272094475761237 -0.091566945003921415558 0.82934312024935918917 0.56464087231543069745 -0.38127131148954074291 0.28651856726245639173 -0.073582045678893606699 0.50253835012540126748;3.3024126458890528113 -2.6935110578248333546 -3.649849506611186456 -0.42961821296478786003 -0.17078781747574889316 -1.0999255161928453983 0.3656776555143944063 -0.58715030320441508049 -0.29719827356519928907 0.030624828712414248894 0.28089988329534598677 0.33747689650222523206 -0.86219155621368248621 0.49057242549643464979 0.59188009045413070286 -1.721188815904278302 1.0795061045698375324 1.8830210457312641648 -0.11810838864074613141 -0.075373054644193943075 -0.3286123392101353291 -0.010501490939927273643 -0.21699556838075512166 -0.79603621604652174959 -0.13274422585518649842 -0.16734154998292058436 -0.05582547047357792197 -0.061584492848975838641 0.30480067121904380611 0.88343532607822794489];

% Layer 2
b2 = 0.45448502525581030431;
LW2_1 = [-1.9734832376272652965 -2.7155072155479405005 6.2275048608096303937 -1.4379849882820916473 4.0646122965339213096 2.1248424167726458478 -4.7550475832479488503 1.2701522743164472828 1.7417217426157016735 -0.68083675085632333612 -1.4382799743481464727 3.8318095463877726026 4.9552693626913235647 2.2145385521737259715 0.027696009325070575224 -3.86640203189080367];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2;
y1_step1.xoffset = 0;

% ===== SIMULATION ========

% Dimensions
TS = size(x1,2); % timesteps

% Input 1 Delay States
xd1 = mapminmax_apply(xi1,x1_step1);
xd1 = [xd1 zeros(3,1)];

% Allocate Outputs
y1 = zeros(1,TS);

% Time loop
for ts=1:TS
    
    % Rotating delay state position
    xdts = mod(ts+9,11)+1;
    
    % Input 1
    xd1(:,xdts) = mapminmax_apply(x1(:,ts),x1_step1);
    
    % Layer 1
    tapdelay1 = reshape(xd1(:,mod(xdts-[1 2 3 4 5 6 7 8 9 10]-1,11)+1),30,1);
    a1 = tansig_apply(b1 + IW1_1*tapdelay1);
    
    % Layer 2
    a2 = b2 + LW2_1*a1;
    
    % Output 1
    y1(:,ts) = mapminmax_reverse(a2,y1_step1);
end

% Final delay states
finalxts = TS+(1: 10);
xits = finalxts(finalxts<=10);
xts = finalxts(finalxts>10)-10;
xf1 = [xi1(:,xits) x1(:,xts)];
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
